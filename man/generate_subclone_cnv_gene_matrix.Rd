% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scdna_subclones.R
\name{generate_subclone_cnv_gene_matrix}
\alias{generate_subclone_cnv_gene_matrix}
\title{Generate subclone-level and tumor-level gene CNV matrices from scDNA-seq data}
\usage{
generate_subclone_cnv_gene_matrix(
  seurat_obj,
  genes_bin,
  scdna_tsv,
  barcode_txt,
  subclone_matrix_out = "scdna_gene_subclones.rds",
  output_dir = "."
)
}
\arguments{
\item{seurat_obj}{Seurat object (or path to RDS file) containing scDNA-seq data, annotated with subclones and cell types}

\item{genes_bin}{gene-bin mapping RData file (should contain a variable genes_bin with $bins, $entrezgene, $symbolgene)}

\item{scdna_tsv}{raw scDNA-seq matrix file (e.g., .tsv or .mtx)}

\item{barcode_txt}{barcode file (e.g., .txt)}

\item{subclone_matrix_out}{save subclone-averaged gene CNV matrix (default 'scdna_gene_subclones.rds')}

\item{output_dir}{Directory to save output files, default is current working directory}
}
\value{
A list with:
  \item{scdna_gene_matrix_tumor}{Gene-level CNV matrix for all tumor cells (genes x cells)}
  \item{scdna_gene_matrix_subclone}{Subclone-averaged gene CNV matrix (subclones x genes)}
}
\description{
This function generates a gene-level CNV matrix for all tumor cells and a subclone-averaged CNV matrix
based on a Seurat object annotated with subclones and cell types. It supports flexible input of gene-bin mapping,
raw scDNA-seq matrix, and barcode files.
}
